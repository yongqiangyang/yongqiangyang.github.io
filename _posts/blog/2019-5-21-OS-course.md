---
layout: post
title: OS课程笔记
categories: blog
description: 刘亮老师的OS课程
keywords: OS，课程笔记
---
# 操作系统课程

## 2019/5/6  

1. 程序的装入链接
  + 装入：绝对装入、可重定位装入、动态运行时装入
    + 绝对装入：适用于单道程序、嵌入式程序。 直接产生绝对地址（物理地址）
    + 可重定位装入：适用于单道程序。逻辑起始地址通常是0，加上基址寄存器即为物理地址。
    + 动态运行时装入：使用于多道程序
  + 链接；静态链接、装入时动态链接、运行时动态链接
    + 静态链接：在磁盘中即链接库函数
    + 装入时动态链接：在程序装入内存时，装入库函数
    + 运行时动态链接：在程序运行时，装入库函数
2. 物理内存分配方案
  + 分类：连续分配存储管理、分页存储管理、虚拟存储管理、分段存储管理
  + 连续分配存储管理：单一连续分配、固定分区分配、可变分区分配
    + 单一连续分配：逻辑地址即物理地址
    + 固定分区分配：分区大小很难确定
    + 可变分区分配
      + 空闲内存分配算法：
        1. 首次适应：每次都是从前到后来分配分区。  
          缺点：在低址部分产生大量碎片。
        2. 循环首次适应：从上次找到的空闲分区的下一个空闲分区进行查找。  
          优点：①避免低址部分产生大量碎片②减少查找空闲分区的时间开销
        3. 最佳适应：选择比自身大中的最小的分区  
          优点：避免"大材小用"
        4. 最坏适应：选择比自身大中的最大的分区  
          优点：产生碎片的可能性最小
      + 容易造成碎片、紧凑需要消耗一定时间
  + 分页存储管理：页面与页框、页表、快表、多级页表（页表项页、页表项）
    + 页面与页框
      + 逻辑地址空间划分为多个页面（page）、物理地址空间划分为多个页框（page frame）
      + 页面大小 = 页框大小
      + 常用大小：4KB
    + 页表
      + 记录页面和页框的对应关系
      + 根据页表进行地址变换 **具体看PPT**
    + 快表
      + 通过硬件实现
      + 引入cache缓存、减少访存次数、增加效率
    + 多级页表
      + 增加页表项页（页表的页表），放置在内核态中
      + 页表项放置在用户态中
      + 二级页表的其他好处：通过减少栈的空洞，来减少页表项，从而实现节省内存

## 2019/5/8

1. （了解即可）反置页表：为了解决早期内存空间较小的缺陷，将逻辑地址和物理地址额查询相反，使得减小页表的空间。
2. 对换技术
  + 定义：内存中暂时不能运行的进程或者暂时不用的程序换出到外存中，以便腾出足够的内存空间
  + 磁盘中开放一片区域，称为对换区，系统设置一个对换进程。
  + 对换空间管理方式：连续存储（提高速度、降低空间利用率）
  + 文件空间管理方式：离散分配（提高空间利用率、降低速度）
  + 方式：若产生缺页，并且内存已经被占满，则选中一块页框放入兑换区，将新页表放入
  + 页表需要增加三项：**存在位，外存地址、修改位**
3. 请求分页虚拟存储管理技术
  + 定义：具有请求调入功能和置换功能，能从逻辑上对内存容量加以扩充的一种存储器系统。
  + 请求分页虚拟存储器管理：linux的工作原理：知道需要某个逻辑地址时，才分配页框。
  + 地址转换：顾名思义
  + 缺页中断：顾名思义
4. 页面置换算法
  + 最佳置换：未来最长时间内不用
  + FIFO：最先进入
  + LRU：最近最久未使用
  + LRU的软件近似算法：aging算法、Clock算法
    + aging算法
      + 工作原理：每隔一段时间，时钟中断到达时，OS做以下处理：  
            将R右移一位 ，且，若页框被访问过，最高位置1  
            最小数值的页面即为最久未被访问的页面
      + 缺陷：
        1. 当计数器有限时，有可能出现多个页框的计数器都为0的情况
        2. 无法区分时钟周期之间的访问次序
    + Clock算法
      + 别名：最久未使用页面置换算法
      + 隐含原理：将时钟周期定时刷新和选择踢出页面两个步骤相结合


## 5/13

1. 分段存储管理
  + 原理：将程序的各个部分（如代码段、数据段、栈段、外部函数库段）等分成相应的段
  + 段表：工作原理与页表类似、**但有一些区别**：长度不一致、放置位置随意
  + 段表的各个项
    1. 段号索引
    2. base：32位物理地址
    3. limit：真正分配的数据
  + 32位地址分配：[9,23]=[段号：段内偏移]
  + 分段与分页的优点
    + 分段优点：利于共享库的共享
    + 分页优点：减少碎片
2. 段页式存储管理
  + 原理：段的limit指向一个页表
  + 32位地址分配：[9,11,12]=[段号；页表号：偏移地址]
3. 内存管理补充
  + linux使用策略：**分页** 思考原因（个人观点）；有些处理器不支持分段
  + 页表项需要与硬件（如MMU）执行相匹配
4. 磁盘管理
  1. 分为 磁道：盘面：扇区
  2. CHS是个三元组，共24bits，
  3. [10,8,6]=[磁道：盘面：扇区]=[cylinder:head:sector]

## 5/16

1. 磁盘调度
  + LAB寻址方式：logical block address
    + 地址线性增加，一块磁盘相当于一个一维数组
  + 磁臂调度算法
    + 先到先服务
    + 最短寻道时间优先
    + 电梯调度算法
    + 循环扫描算法
  + 磁盘调度算法在 **驱动程序** 中实现
2.
